{"version":3,"sources":["webpack:///p5-widget.js","webpack:///webpack/bootstrap 2cd086ecffe360d3cd04","webpack:///./lib/p5-widget.ts","webpack:///./lib/defaults.ts"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","getMyBaseURL","url","baseURL","slice","MY_FILENAME","length","AVOID_MIXED_CONTENT_WARNINGS","window","location","protocol","test","replace","getMyScriptEl","document","currentScript","querySelectorAll","isElementInViewport","el","rect","getBoundingClientRect","bottom","right","top","innerHeight","documentElement","clientHeight","left","innerWidth","clientWidth","getDataHeight","height","parseInt","getAttribute","isNaN","defaults","HEIGHT","absoluteURL","a","createElement","setAttribute","href","getSketch","cb","error","msg","lines","push","join","req","XMLHttpRequest","open","onload","status","responseText","onerror","send","replaceScriptWithWidget","makeWidget","sketch","qsArgs","encodeURIComponent","style","myBaseURL","IFRAME_FILENAME","iframe","parentNode","replaceChild","previewWidth","baseSketchURL","p5version","autoplay","hasAttribute","IFRAME_STYLE","src","textContent","trim","whenVisible","maybeMakeVisible","clearInterval","interval","removeEventListener","setInterval","addEventListener","lazilyReplaceScriptWithWidget","display","fontSize","width","minHeight","background","nextId","toString","lazilyReplaceAllScriptsWithWidget","scripts","forEach","myScriptEl","autoload","readyState","replaceScript","replaceAll","P5_VERSION","PREVIEW_WIDTH"],"mappings":"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","file":"p5-widget.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar defaults = __webpack_require__(1);\r\n\tvar MY_FILENAME = 'p5-widget.js';\r\n\tvar IFRAME_FILENAME = 'p5-widget.html';\r\n\tvar IFRAME_STYLE = [\r\n\t    'width: 100%',\r\n\t    'background-color: white',\r\n\t    'border: 1px solid #ec245e',\r\n\t    'box-sizing: border-box'\r\n\t];\r\n\tvar AVOID_MIXED_CONTENT_WARNINGS = true;\r\n\tvar myScriptEl = getMyScriptEl();\r\n\tvar myBaseURL = getMyBaseURL(myScriptEl.src);\r\n\tvar autoload = !myScriptEl.hasAttribute('data-manual');\r\n\tvar nextId = 1;\r\n\tfunction getMyBaseURL(url) {\r\n\t    var baseURL = url.slice(0, -MY_FILENAME.length);\r\n\t    if (AVOID_MIXED_CONTENT_WARNINGS) {\r\n\t        if (window.location.protocol === 'http:' && /^https:/.test(baseURL)) {\r\n\t            // Our script was loaded over HTTPS, but the embedding page is\r\n\t            // using HTTP. This is likely to result in mixed content warnings\r\n\t            // if e.g. the widget's sketch wants to load resources relative to\r\n\t            // the embedding page's URL, so let's just embed the widget over\r\n\t            // HTTP instead of HTTPS.\r\n\t            baseURL = baseURL.replace('https:', 'http:');\r\n\t        }\r\n\t    }\r\n\t    return baseURL;\r\n\t}\r\n\tfunction getMyScriptEl() {\r\n\t    return (document.currentScript ||\r\n\t        document.querySelectorAll(\"script[src$='\" + MY_FILENAME + \"']\")[0]);\r\n\t}\r\n\t// http://stackoverflow.com/a/7557433/2422398\r\n\tfunction isElementInViewport(el) {\r\n\t    var rect = el.getBoundingClientRect();\r\n\t    return (rect.bottom >= 0 &&\r\n\t        rect.right >= 0 &&\r\n\t        rect.top <= (window.innerHeight ||\r\n\t            document.documentElement.clientHeight) &&\r\n\t        rect.left <= (window.innerWidth ||\r\n\t            document.documentElement.clientWidth));\r\n\t}\r\n\tfunction getDataHeight(el) {\r\n\t    var height = parseInt(el.getAttribute('data-height'));\r\n\t    if (isNaN(height))\r\n\t        height = defaults.HEIGHT;\r\n\t    return height;\r\n\t}\r\n\tfunction absoluteURL(url) {\r\n\t    var a = document.createElement('a');\r\n\t    a.setAttribute('href', url);\r\n\t    return a.href;\r\n\t}\r\n\tfunction getSketch(url, cb) {\r\n\t    var error = function (msg) {\r\n\t        var lines = ['// p5.js-widget failed to retrieve ' + url + '.'];\r\n\t        if (msg && typeof (msg) == 'string') {\r\n\t            lines.push('// ' + msg);\r\n\t        }\r\n\t        cb(lines.join('\\n'));\r\n\t    };\r\n\t    var req = new XMLHttpRequest();\r\n\t    req.open('GET', url);\r\n\t    req.onload = function () {\r\n\t        if (req.status == 200) {\r\n\t            cb(req.responseText);\r\n\t        }\r\n\t        else {\r\n\t            error('Server returned HTTP ' + req.status + '.');\r\n\t        }\r\n\t    };\r\n\t    req.onerror = error;\r\n\t    req.send(null);\r\n\t}\r\n\tfunction replaceScriptWithWidget(el) {\r\n\t    var iframe = document.createElement('iframe');\r\n\t    var height = getDataHeight(el);\r\n\t    var previewWidth = parseInt(el.getAttribute('data-preview-width'));\r\n\t    var baseSketchURL = absoluteURL(el.getAttribute('data-base-url'));\r\n\t    var p5version = el.getAttribute('data-p5-version');\r\n\t    var autoplay = el.hasAttribute('data-autoplay');\r\n\t    var url;\r\n\t    var qsArgs = [\r\n\t        'id=' + encodeURIComponent(el.getAttribute('data-id'))\r\n\t    ];\r\n\t    var style = IFRAME_STYLE.slice();\r\n\t    function makeWidget(sketch) {\r\n\t        qsArgs.push('sketch=' + encodeURIComponent(sketch));\r\n\t        style.push('min-height: ' + height + 'px');\r\n\t        url = myBaseURL + IFRAME_FILENAME + '?' + qsArgs.join('&');\r\n\t        iframe.setAttribute('src', url);\r\n\t        iframe.setAttribute('style', style.join('; '));\r\n\t        el.parentNode.replaceChild(iframe, el);\r\n\t    }\r\n\t    if (!isNaN(previewWidth) && previewWidth >= 0) {\r\n\t        qsArgs.push('previewWidth=' + previewWidth);\r\n\t    }\r\n\t    if (baseSketchURL) {\r\n\t        qsArgs.push('baseSketchURL=' + encodeURIComponent(baseSketchURL));\r\n\t    }\r\n\t    if (p5version) {\r\n\t        qsArgs.push('p5version=' + encodeURIComponent(p5version));\r\n\t    }\r\n\t    if (autoplay) {\r\n\t        qsArgs.push('autoplay=on');\r\n\t    }\r\n\t    if (el.src && el.textContent && el.textContent.trim()) {\r\n\t        return makeWidget([\r\n\t            '// Your widget includes both a \"src\" attribute and inline script',\r\n\t            '// content, which makes no sense. Please remove one of them.'\r\n\t        ].join('\\n'));\r\n\t    }\r\n\t    if (el.src) {\r\n\t        getSketch(el.src, makeWidget);\r\n\t    }\r\n\t    else {\r\n\t        makeWidget(el.textContent);\r\n\t    }\r\n\t}\r\n\tfunction whenVisible(el, cb) {\r\n\t    var CHECK_INTERVAL_MS = 1000;\r\n\t    var interval;\r\n\t    function maybeMakeVisible() {\r\n\t        if (!isElementInViewport(el))\r\n\t            return;\r\n\t        clearInterval(interval);\r\n\t        window.removeEventListener('scroll', maybeMakeVisible, false);\r\n\t        window.removeEventListener('resize', maybeMakeVisible, false);\r\n\t        cb(el);\r\n\t    }\r\n\t    // We want to check at a fixed interval as a fallback, to make\r\n\t    // sure that we detect when the element is visible even outside\r\n\t    // of the usual means (e.g., because the user did some\r\n\t    // sort of pinch/zoom gesture).\r\n\t    interval = setInterval(maybeMakeVisible, 1000);\r\n\t    window.addEventListener('scroll', maybeMakeVisible, false);\r\n\t    window.addEventListener('resize', maybeMakeVisible, false);\r\n\t    maybeMakeVisible();\r\n\t}\r\n\tfunction lazilyReplaceScriptWithWidget(el) {\r\n\t    var height = getDataHeight(el);\r\n\t    el.style.display = 'block';\r\n\t    el.style.fontSize = '0';\r\n\t    el.style.width = '100%';\r\n\t    el.style.minHeight = height + 'px';\r\n\t    el.style.background = '#f0f0f0';\r\n\t    if (!el.hasAttribute('data-id')) {\r\n\t        el.setAttribute('data-id', nextId.toString());\r\n\t        nextId++;\r\n\t    }\r\n\t    whenVisible(el, replaceScriptWithWidget);\r\n\t}\r\n\tfunction lazilyReplaceAllScriptsWithWidget() {\r\n\t    var scripts = document.querySelectorAll(\"script[type='text/p5']\");\r\n\t    [].slice.call(scripts).forEach(function (el) {\r\n\t        lazilyReplaceScriptWithWidget(el);\r\n\t    });\r\n\t}\r\n\tif (autoload) {\r\n\t    if (document.readyState === 'complete') {\r\n\t        lazilyReplaceAllScriptsWithWidget();\r\n\t    }\r\n\t    else {\r\n\t        window.addEventListener('load', lazilyReplaceAllScriptsWithWidget, false);\r\n\t    }\r\n\t}\r\n\twindow['p5Widget'] = {\r\n\t    baseURL: myBaseURL,\r\n\t    url: myBaseURL + MY_FILENAME,\r\n\t    replaceScript: lazilyReplaceScriptWithWidget,\r\n\t    replaceAll: lazilyReplaceAllScriptsWithWidget,\r\n\t    defaults: defaults\r\n\t};\r\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.P5_VERSION = '0.4.23';\r\n\texports.PREVIEW_WIDTH = 150;\r\n\texports.HEIGHT = 300;\r\n\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** p5-widget.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2cd086ecffe360d3cd04\n **/","import * as defaults from \"./defaults\";\r\n\r\nconst MY_FILENAME = 'p5-widget.js';\r\nconst IFRAME_FILENAME = 'p5-widget.html';\r\nconst IFRAME_STYLE = [\r\n  'width: 100%',\r\n  'background-color: white',\r\n  'border: 1px solid #ec245e',\r\n  'box-sizing: border-box'\r\n];\r\nconst AVOID_MIXED_CONTENT_WARNINGS = true;\r\n\r\nlet myScriptEl = getMyScriptEl() as HTMLScriptElement;\r\nlet myBaseURL = getMyBaseURL(myScriptEl.src);\r\nlet autoload = !myScriptEl.hasAttribute('data-manual');\r\nlet nextId = 1;\r\n\r\nfunction getMyBaseURL(url: string) {\r\n  let baseURL = url.slice(0, -MY_FILENAME.length);\r\n\r\n  if (AVOID_MIXED_CONTENT_WARNINGS) {\r\n    if (window.location.protocol === 'http:' && /^https:/.test(baseURL)) {\r\n      // Our script was loaded over HTTPS, but the embedding page is\r\n      // using HTTP. This is likely to result in mixed content warnings\r\n      // if e.g. the widget's sketch wants to load resources relative to\r\n      // the embedding page's URL, so let's just embed the widget over\r\n      // HTTP instead of HTTPS.\r\n\r\n      baseURL = baseURL.replace('https:', 'http:');\r\n    }\r\n  }\r\n\r\n  return baseURL;\r\n}\r\n\r\nfunction getMyScriptEl() {\r\n  return (\r\n    document.currentScript ||\r\n    document.querySelectorAll(\"script[src$='\" + MY_FILENAME + \"']\")[0]\r\n  );\r\n}\r\n\r\n// http://stackoverflow.com/a/7557433/2422398\r\nfunction isElementInViewport(el: HTMLElement) {\r\n  var rect = el.getBoundingClientRect();\r\n\r\n  return (\r\n    rect.bottom >= 0 &&\r\n    rect.right >= 0 &&\r\n    rect.top <= (window.innerHeight ||\r\n                 document.documentElement.clientHeight) &&\r\n    rect.left <= (window.innerWidth ||\r\n                  document.documentElement.clientWidth)\r\n  );\r\n}\r\n\r\nfunction getDataHeight(el: HTMLScriptElement) {\r\n  let height = parseInt(el.getAttribute('data-height'));\r\n\r\n  if (isNaN(height)) height = defaults.HEIGHT;\r\n\r\n  return height;\r\n}\r\n\r\nfunction absoluteURL(url: string) {\r\n  let a = document.createElement('a');\r\n  a.setAttribute('href', url);\r\n\r\n  return a.href;\r\n}\r\n\r\nfunction getSketch(url: string, cb: (sketch: string) => any) {\r\n  let error = (msg?: any) => {\r\n    let lines = ['// p5.js-widget failed to retrieve ' + url + '.'];\r\n\r\n    if (msg && typeof(msg) == 'string') {\r\n      lines.push('// ' + msg);\r\n    }\r\n\r\n    cb(lines.join('\\n'));\r\n  };\r\n  let req = new XMLHttpRequest();\r\n  req.open('GET', url);\r\n\r\n  req.onload = () => {\r\n    if (req.status == 200) {\r\n      cb(req.responseText);\r\n    } else {\r\n      error('Server returned HTTP ' + req.status + '.');\r\n    }\r\n  };\r\n\r\n  req.onerror = error;\r\n  req.send(null);\r\n}\r\n\r\nfunction replaceScriptWithWidget(el: HTMLScriptElement) {\r\n  let iframe = document.createElement('iframe');\r\n  let height = getDataHeight(el);\r\n  let previewWidth = parseInt(el.getAttribute('data-preview-width'));\r\n  let baseSketchURL = absoluteURL(el.getAttribute('data-base-url'));\r\n  let p5version = el.getAttribute('data-p5-version');\r\n  let autoplay = el.hasAttribute('data-autoplay');\r\n  let url;\r\n  let qsArgs = [\r\n    'id=' + encodeURIComponent(el.getAttribute('data-id'))\r\n  ];\r\n  let style = IFRAME_STYLE.slice();\r\n\r\n  function makeWidget(sketch: string) {\r\n    qsArgs.push('sketch=' + encodeURIComponent(sketch));\r\n    style.push('min-height: ' + height + 'px');\r\n    url = myBaseURL + IFRAME_FILENAME + '?' + qsArgs.join('&');\r\n    iframe.setAttribute('src', url);\r\n    iframe.setAttribute('style', style.join('; '));\r\n    el.parentNode.replaceChild(iframe, el);\r\n  }\r\n\r\n  if (!isNaN(previewWidth) && previewWidth >= 0) {\r\n    qsArgs.push('previewWidth=' + previewWidth);\r\n  }\r\n\r\n  if (baseSketchURL) {\r\n    qsArgs.push('baseSketchURL=' + encodeURIComponent(baseSketchURL));\r\n  }\r\n\r\n  if (p5version) {\r\n    qsArgs.push('p5version=' + encodeURIComponent(p5version));\r\n  }\r\n\r\n  if (autoplay) {\r\n    qsArgs.push('autoplay=on');\r\n  }\r\n\r\n  if (el.src && el.textContent && el.textContent.trim()) {\r\n    return makeWidget([\r\n      '// Your widget includes both a \"src\" attribute and inline script',\r\n      '// content, which makes no sense. Please remove one of them.'\r\n    ].join('\\n'));\r\n  }\r\n\r\n  if (el.src) {\r\n    getSketch(el.src, makeWidget);\r\n  } else {\r\n    makeWidget(el.textContent);\r\n  }\r\n}\r\n\r\nfunction whenVisible(el: HTMLScriptElement,\r\n                     cb: (el: HTMLScriptElement) => void) {\r\n  let CHECK_INTERVAL_MS = 1000;\r\n  let interval: number;\r\n\r\n  function maybeMakeVisible() {\r\n    if (!isElementInViewport(el)) return;\r\n\r\n    clearInterval(interval);\r\n    window.removeEventListener('scroll', maybeMakeVisible, false);\r\n    window.removeEventListener('resize', maybeMakeVisible, false);\r\n    cb(el);\r\n  }\r\n\r\n  // We want to check at a fixed interval as a fallback, to make\r\n  // sure that we detect when the element is visible even outside\r\n  // of the usual means (e.g., because the user did some\r\n  // sort of pinch/zoom gesture).\r\n  interval = setInterval(maybeMakeVisible, 1000);\r\n\r\n  window.addEventListener('scroll', maybeMakeVisible, false);\r\n  window.addEventListener('resize', maybeMakeVisible, false);\r\n  maybeMakeVisible();\r\n}\r\n\r\nfunction lazilyReplaceScriptWithWidget(el: HTMLScriptElement) {\r\n  let height = getDataHeight(el);\r\n\r\n  el.style.display = 'block';\r\n  el.style.fontSize = '0';\r\n  el.style.width = '100%';\r\n  el.style.minHeight = height + 'px';\r\n  el.style.background = '#f0f0f0';\r\n\r\n  if (!el.hasAttribute('data-id')) {\r\n    el.setAttribute('data-id', nextId.toString());\r\n    nextId++;\r\n  }\r\n\r\n  whenVisible(el, replaceScriptWithWidget);\r\n}\r\n\r\nfunction lazilyReplaceAllScriptsWithWidget() {\r\n  let scripts = document.querySelectorAll(\"script[type='text/p5']\");\r\n\r\n  [].slice.call(scripts).forEach((el: HTMLScriptElement) => {\r\n    lazilyReplaceScriptWithWidget(el);\r\n  });\r\n}\r\n\r\nif (autoload) {\r\n  if (document.readyState === 'complete') {\r\n    lazilyReplaceAllScriptsWithWidget();\r\n  } else {\r\n    window.addEventListener(\r\n      'load',\r\n      lazilyReplaceAllScriptsWithWidget,\r\n      false\r\n    );\r\n  }\r\n}\r\n\r\nwindow['p5Widget'] = {\r\n  baseURL: myBaseURL,\r\n  url: myBaseURL + MY_FILENAME,\r\n  replaceScript: lazilyReplaceScriptWithWidget,\r\n  replaceAll: lazilyReplaceAllScriptsWithWidget,\r\n  defaults: defaults\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/p5-widget.ts\n **/","export const P5_VERSION = '0.4.23';\nexport const PREVIEW_WIDTH = 150;\nexport const HEIGHT = 300;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/defaults.ts\n **/"],"sourceRoot":""}